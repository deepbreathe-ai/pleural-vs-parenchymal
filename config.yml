PATHS:
  FRAMES_TABLE: 'data/frames_table_val.csv'
  FRAMES_DIR: 'data/frames/'
  CLIPS_TABLE: 'data/clips_table_val.csv'
  PARTITIONS_DIR: 'data/partitions/'
  RAW_CLIPS_DIR: 'data/raw_clips/'
  MASKED_CLIPS_DIR: 'data/masked_clips/'
  DATABASE_QUERY: 'data/train_query.csv'
  TEST_FRAMES_TABLE: 'data/internal_accuracy/frames.csv'
  TEST_CLIPS_TABLE: 'data/internal_accuracy/clips_table.csv'
  FRAME_PREDICTIONS: 'results/metrics/frames_20220627.json'
  EXPERIMENT_VISUALIZATIONS: 'img/experiments'
  MODEL_TO_LOAD: 'src/models/model20220212-163128-efficientnetb0-seed1_hackathon.h5'
  HEATMAPS: 'img/heatmaps'
  LOGS: 'results/logs/'
  IMAGES: 'results/figures/'
  MODEL_WEIGHTS: 'results/models/'
  BATCH_PREDS: 'results/predictions/'
  METRICS: './results/metrics/'
  EXPERIMENTS: 'results/experiments/'
  EXPERIMENT_IMG: './img/experiments/'

DATA:
  IMG_DIM: [128, 128]
  VAL_SPLIT: 0.1
  TEST_SPLIT: 0.1
  CLASSES: ['parenchymal', 'pleural']   # Classes for binary classification

TRAIN:
  MODEL_DEF: 'efficientnetb0'
  N_CLASSES: 2
  BATCH_SIZE: 4
  EPOCHS: 15
  PATIENCE: 5
  EXPERIMENT_TYPE: 'cross_validation'   # One of {'single_train', 'hparam_search', 'cross_validation'}
  N_FOLDS: 10
  DATA_AUG:
    ZOOM_RANGE: 0.2
    HORIZONTAL_FLIP: true
    WIDTH_SHIFT_RANGE: 0.2
    HEIGHT_SHIFT_RANGE: 0.2
    SHEAR_RANGE: 10
    ROTATION_RANGE: 0.125   # Fraction of 2*pi
    BRIGHTNESS_RANGE: 0.2
    CONTRAST_RANGE: 0.1
  MEMORY_LIMIT: 1228

HPARAMS:
  MOBILENETV2:
    LR: 0.0001
    DROPOUT: 0.4
    L2_LAMBDA: 0.0001
    NODES_FC0: 32
    FROZEN_LAYERS: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,16,17,18,19,20,21,22,23,24,25,26,26,27,28,29,30]
  INCEPTIONV3:
    LR: 0.0001
    DROPOUT: 0.4
    L2_LAMBDA: 0.0001
    NODES_FC0: 32
    FROZEN_LAYERS: [ 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]
  RESNET50V2:
    LR: 0.0001
    DROPOUT: 0.4
    L2_LAMBDA: 0.0001
    NODES_FC0: 32
    FROZEN_LAYERS: [ 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]
  RESNET14V2:
    LR: 0.0001
    DROPOUT: 0.5
    L2_LAMBDA: 0.0001
    NODES_FC0: 32
    FROZEN_LAYERS: [ 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]
  EFFICIENTNETB0:
    LR: 0.000001
    DROPOUT: 0.3
    L2_LAMBDA: 0.0001
    NODES_FC0: 128
    FROZEN_LAYERS: 0 #[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300]
  VGG16:
    LR: 0.01
    DROPOUT: 0.4
    L2_LAMBDA: 0.01
    NODES_DENSE0: 64
    FROZEN_LAYERS: []
  CUTOFFVGG16:
    LR_EXTRACT: 0.0003
    LR_FINETUNE: 0.0000093
    DROPOUT: 0.45
    CUTOFF_LAYER: 10
    FINETUNE_LAYER: 7
    EXTRACT_EPOCHS: 5
  CUTOFFRESNET50V2:
    DEPTH: 56 #should be 9n +2 (ex: 56 or 110)
    LR: 0.01
    DROPOUT: 0.5
    L2_LAMBDA: 0.01
    NODES_DENSE0: 64
    FROZEN_LAYERS: [ ]

CLIP_PREDICTION:
  CLASSIFICATION_THRESHOLD: 0.7
  CLIP_PREDICTION_METHOD: 'contiguity_threshold_with_smoothing'   # one of {'majority_vote', 'average', 'max_sliding_window', 'contiguity_threshold', 'contiguity_threshold_with_smoothing', 'longest_window'}
  WINDOW_SIZE: 20
  CONTIGUITY_THRESHOLD: 7 # Number of consecutive pleural frames to predict pleural
  SMOOTHING_WINDOW: 17 # Width of the moving average window used to smooth prediction probabilities
  WINDOW_CERTAINTY: 0.2

HPARAM_SEARCH:
  OBJECTIVE: 'accuracy'
  N_TRIALS: 15
  EFFICIENTNETB0:
    LR:
      TYPE: 'float_log'
      RANGE: [0.000001, 0.001]
    DROPOUT:
      TYPE: 'float_uniform'
      RANGE: [0.0, 0.6]
    L2_LAMBDA:
      TYPE: 'float_log'
      RANGE: [0.000000001, 0.00001]
    NODES_FC0:
      TYPE: 'set'
      RANGE: [16, 32, 64, 128]